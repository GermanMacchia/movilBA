@if (entidad$ | async; as entidad) {
	<div class="container mx-auto p-6">
		<div class="grid grid-cols-1 md:grid-cols-2 gap-6">
			<!-- Información General -->
			<div>
				<lib-info-card [data]="getInfoGeneralCard(entidad)"></lib-info-card>
			</div>

			<!-- Estadísticas -->
			<div>
				<lib-info-card [data]="getEstadisticasCard(entidad)"></lib-info-card>
			</div>

			<!-- Contacto Principal-->
			<div>
				<lib-info-card [data]="getContactoPrincipalCard(entidad)"></lib-info-card>
			</div>

			<!-- Contactos Adicionales -->
			@if (
				(entidad?.telefonos && entidad.telefonos.length > 0) ||
				(entidad?.correos && entidad.correos.length > 0)
			) {
				<div>
					<lib-info-card
						[data]="getContactosAdicionalesCard(entidad)"></lib-info-card>
				</div>
			}

			<!-- Líneas -->
			@if (lineas$ | async; as lineas) {
				<div
					class="bg-white rounded-lg shadow-sm border border-gray-200 hover:shadow-md transition-shadow duration-200 md:col-span-2 h-full flex flex-col">
					<div class="p-6 flex-1 flex flex-col">
						<div class="flex items-center mb-6">
							<div
								class="w-10 h-10 bg-gray-100 rounded-lg flex items-center justify-center mr-3">
								<i class="bi bi-diagram-3 text-gray-600 text-lg"></i>
							</div>
							<h2 class="text-lg font-semibold text-gray-900">
								Líneas ({{ lineas.length }})
							</h2>
						</div>

						@if (lineas.length > 0) {
							<!-- Grid de tarjetas de líneas -->
							<div
								class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 flex-1">
								@for (linea of lineas; track linea.numero_linea) {
									<app-linea-card
										[linea]="linea"
										(onCardClick)="onLineaCardClick($event)"
										(onViewDetails)="onLineaViewDetails($event)">
									</app-linea-card>
								}
							</div>
						} @else {
							<!-- Mensaje cuando no hay líneas -->
							<div class="flex-1 flex items-center justify-center">
								<div class="text-center py-12">
									<div
										class="w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4">
										<i class="bi bi-diagram-3 text-gray-400 text-2xl"></i>
									</div>
									<h3 class="text-lg font-medium text-gray-900 mb-2">
										No hay líneas registradas
									</h3>
									<p class="text-gray-500 text-sm">
										Esta entidad no tiene líneas de transporte asociadas.
									</p>
								</div>
							</div>
						}
					</div>
				</div>
			}

			<!-- Vehículos usando SimpleList -->
			@if (vehiculos$ | async; as vehiculos) {
				<div
					class="bg-white rounded-lg shadow-sm border border-gray-200 hover:shadow-md transition-shadow duration-200 md:col-span-2 h-full flex flex-col">
					<div class="p-6 flex-1 flex flex-col">
						<div class="flex items-center mb-6">
							<div
								class="w-10 h-10 bg-gray-100 rounded-lg flex items-center justify-center mr-3">
								<i class="bi bi-truck text-gray-600 text-lg"></i>
							</div>
							<h2 class="text-lg font-semibold text-gray-900">
								Vehículos ({{ vehiculos.length }})
							</h2>
						</div>

						@if (vehiculos.length > 0) {
							<!-- Lista de vehículos con simple-list -->
							<div class="flex-1">
								<lib-simple-list
									[showSearch]="true"
									[data]="vehiculos"
									[headers]="getVehiculosHeaders()"
									[dataKeys]="getVehiculosDataKeys()"
									[actions]="getVehiculosActions()">
								</lib-simple-list>
							</div>
						} @else {
							<!-- Mensaje cuando no hay vehículos -->
							<div class="flex-1 flex items-center justify-center">
								<div class="text-center py-12">
									<div
										class="w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4">
										<i class="bi bi-truck text-gray-400 text-2xl"></i>
									</div>
									<h3 class="text-lg font-medium text-gray-900 mb-2">
										No hay vehículos registrados
									</h3>
									<p class="text-gray-500 text-sm">
										Esta entidad no tiene vehículos asociados en el sistema.
									</p>
								</div>
							</div>
						}
					</div>
				</div>
			}
		</div>
	</div>
}

<!-- Modal de detalles de linea -->
<app-modal-lineas
	[modalAbierto]="modalLineaAbierto"
	[lineaSeleccionada]="lineaSeleccionada"
	(cerrarModal)="cerrarModalLinea()">
</app-modal-lineas>

<!-- Modal de detalles de vehículo -->
<app-modal-vehiculos
	[modalAbierto]="modalVehiculoAbierto"
	[vehiculoSeleccionado]="vehiculoSeleccionado"
	(cerrarModal)="cerrarModalVehiculo()">
</app-modal-vehiculos>
